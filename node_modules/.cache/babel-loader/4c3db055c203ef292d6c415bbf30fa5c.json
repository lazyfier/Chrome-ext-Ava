{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nexport default {\n  name: 'app',\n\n  data() {\n    return {\n      isGif: false,\n      workmode: false,\n      search_mode: '历史记录',\n      screenshotPopover: false,\n      pngurl: 'assets/start.png',\n      gifurl: 'assets/start.gif',\n      search_input: '',\n      savedTabsGroupList: {},\n      saveTabsGroupForm: {\n        groupName: ''\n      },\n      reloadTabsGroupForm: {\n        groupName: ''\n      },\n      drawer: false,\n      testurl: \"https://cn-hbwh-fx-bcache-07.bilivideo.com/upgcxcode/93/46/496394693/496394693-1-208.mp4?e=ig8euxZM2rNcNbRH7bdVhwdlhWejhwdVhoNvNC8BqJIzNbfq9rVEuxTEnE8L5F6VnEsSTx0vkX8fqJeYTj_lta53NCM=&uipk=5&nbs=1&deadline=1649952886&gen=playurlv2&os=bcache&oi=1939639253&trid=00008d13e1dbb5004d588c99cb996dd2372bT&platform=html5&upsig=76a789f9b03595e4f7b55d17e28063d1&uparams=e,uipk,nbs,deadline,gen,os,oi,trid,platform&cdnid=3877&mid=23178869&bvc=vod&nettype=0&bw=196134&orderid=0,1&logo=80000000\"\n    };\n  },\n\n  methods: {\n    screenshot() {\n      chrome.tabs.captureVisibleTab(null, {\n        format: \"png\",\n        quality: 100\n      }, img_url => {\n        chrome.downloads.download({\n          url: img_url,\n          saveAs: true\n        }, res => {\n          console.log(res);\n        });\n      });\n    },\n\n    getTabs() {\n      chrome.tabs.query({}, tabs => {\n        var urls = tabs.map(tab => {\n          return tab.url;\n        });\n        chrome.storage.local.set({\n          \"test\": urls\n        });\n      });\n    },\n\n    getSavedTabsGroupList() {\n      chrome.storage.local.get(\"savedTabsGroupList\", entry => {\n        this.savedTabsGroupList = typeof entry.savedTabsGroupList == 'undefined' ? {} : entry.savedTabsGroupList;\n      });\n    },\n\n    saveTabsGroup() {\n      chrome.tabs.query({}, tabs => {\n        var urls = tabs.map(tab => {\n          return tab.url;\n        });\n        this.savedTabsGroupList[this.saveTabsGroupForm.groupName] = urls;\n        chrome.storage.local.set({\n          \"savedTabsGroupList\": this.savedTabsGroupList\n        });\n      });\n    },\n\n    reloadTabsGroup() {\n      chrome.storage.local.get(\"savedTabsGroupList\", entry => {\n        entry.savedTabsGroupList[this.reloadTabsGroupForm.groupName].forEach(URL => {\n          chrome.tabs.create({\n            url: URL\n          });\n        });\n      });\n    },\n\n    reset() {\n      chrome.storage.local.clear(() => {\n        console.log(\"clear\");\n      });\n    },\n\n    deleteTabsGroup() {\n      console.log(this.savedTabsGroupList);\n      chrome.storage.local.get(\"savedTabsGroupList\", entry => {\n        this.savedTabsGroupList = typeof entry.savedTabsGroupList == 'undefined' ? {} : entry.savedTabsGroupList;\n        delete entry.savedTabsGroupList[this.reloadTabsGroupForm.groupName];\n        console.log(this.savedTabsGroupList);\n        chrome.storage.local.set({\n          \"savedTabsGroupList\": this.savedTabsGroupList\n        });\n      });\n    },\n\n    testdownload() {\n      console.log(\"testdownload\");\n      console.log(this.testurl);\n      chrome.downloads.download({\n        url: this.testurl,\n        saveAs: true\n      });\n    },\n\n    downloadBiliVideo() {\n      chrome.tabs.query({\n        currentWindow: true,\n        active: true\n      }, tabs => {\n        var bv = tabs[0].url.match(/[\\s\\S]*(BV[a-z|A-Z|0-9]{10})[\\s\\S]*/)[1];\n        var aidModel = \"https://api.bilibili.com/x/web-interface/archive/stat?bvid=\";\n        var cidModel = \"https://api.bilibili.com/x/player/pagelist?bvid=\";\n        let requests = [];\n        let getAid = new Promise(resolve => {\n          axios({\n            method: \"GET\",\n            url: aidModel + bv\n          }).then(res => resolve(res));\n        });\n        requests.push(getAid);\n        let getCid = new Promise(resolve => {\n          axios({\n            method: \"GET\",\n            url: cidModel + bv\n          }).then(res => resolve(res));\n        });\n        requests.push(getCid);\n        Promise.all(requests).then(replist => {\n          var aid = replist[0].data.data.aid;\n          var cid = replist[1].data.data[0].cid;\n          var req = \"https://api.bilibili.com/x/player/playurl?avid=\" + aid + \"&cid=\" + cid + \"&qn=1&type=&otype=json&platform=html5&high_quality=1\";\n          axios({\n            method: \"GET\",\n            url: req\n          }).then(res => {\n            var videoURL = res.data.data.durl[0].url;\n            console.log(videoURL);\n            chrome.downloads.download({\n              url: videoURL,\n              saveAs: true\n            });\n          });\n        });\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkIA;AACA;AACAA,aADA;;AAEAC;AACA;AACAC,kBADA;AAEAC,qBAFA;AAGAC,yBAHA;AAIAC,8BAJA;AAKAC,gCALA;AAMAC,gCANA;AAOAC,sBAPA;AAQAC,4BARA;AASAC;AAAAC;AAAA,OATA;AAUAC;AAAAD;AAAA,OAVA;AAWAE,mBAXA;AAYAC;AAZA;AAcA,GAjBA;;AAkBAC;AACAC;AACAC;AAAAC;AAAAC;AAAA;AACAF;AAAAG;AAAAC;AAAA;AAAAC;AAAA;AACA,OAFA;AAGA,KALA;;AAMAC;AACAN;AACA;AAAA;AAAA;AACAA;AAAA;AAAA;AACA,OAHA;AAIA,KAXA;;AAYAO;AACAP;AACA;AACA,OAFA;AAGA,KAhBA;;AAiBAQ;AACAR;AACA;AAAA;AAAA;AACA;AACAA;AAAA;AAAA;AACA,OAJA;AAKA,KAvBA;;AAwBAS;AACAT;AACAU;AAAAV;AAAAG;AAAA;AAAA;AACA,OAFA;AAGA,KA5BA;;AA6BAQ;AACAX;AAAAK;AAAA;AACA,KA/BA;;AAgCAO;AACAP;AACAL;AACA;AACA;AACAK;AACAL;AAAA;AAAA;AACA,OALA;AAMA,KAxCA;;AAyCAa;AACAR;AACAA;AACAL;AAAAG;AAAAC;AAAA;AACA,KA7CA;;AA8CAU;AACAd;AAAAe;AAAAC;AAAA;AACA;AACA;AACA;AACA;AACA;AACAC;AAAAC;AAAAf;AAAA;AACA,SAFA;AAGAgB;AACA;AACAF;AAAAC;AAAAf;AAAA;AACA,SAFA;AAGAgB;AACAC;AACA;AACA;AACA;AACAH;AAAAC;AAAAf;AAAA;AACA;AACAE;AACAL;AAAAG;AAAAC;AAAA;AACA,WAJA;AAKA,SATA;AAUA,OAvBA;AAwBA;;AAvEA;AAlBA","names":["name","data","isGif","workmode","search_mode","screenshotPopover","pngurl","gifurl","search_input","savedTabsGroupList","saveTabsGroupForm","groupName","reloadTabsGroupForm","drawer","testurl","methods","screenshot","chrome","format","quality","url","saveAs","console","getTabs","getSavedTabsGroupList","saveTabsGroup","reloadTabsGroup","entry","reset","deleteTabsGroup","testdownload","downloadBiliVideo","currentWindow","active","axios","method","requests","Promise"],"sourceRoot":"src/popup/App","sources":["App.vue"],"sourcesContent":["<template>\n  <el-container style=\"width:400px; height: 500px; border-radius: 8px; background:#9AC8E280;\">\n    <el-header style=\"text-align: right; font-size: 12px; height: 100px; margin: 20px 0px 0px 0px\" >\n      <el-row :gutter=\"20\" type=\"flex\" align=\"bottom\">\n        <el-col :span=\"8\">\n          <div @mouseenter=\"isGif = true\"\n          @mouseleave=\"isGif = false\" >\n          <el-avatar v-if = \"isGif\" :src=\"gifurl\"\n          style=\"width: 100px; height: 100px; background:#9AC8E200;\"\n          fit=\"fill\"></el-avatar>\n          <el-avatar v-else :src=\"pngurl\"\n          style=\"width: 100px; height: 100px; background:#9AC8E200;\"\n          fit=\"fill\"></el-avatar>\n          </div>\n        </el-col>\n        <el-col :span=\"16\">\n          <el-row type=\"flex\" justify=\"start\">\n            <el-radio-group v-model=\"search_mode\" size=\"mini\">\n              <el-radio-button label=\"历史记录\"><i class=\"el-icon-time\"></i></el-radio-button>\n              <el-radio-button label=\"收藏\"><i class=\"el-icon-star-off\"></i></el-radio-button>\n              <el-radio-button label=\"翻译\"><i class=\"el-icon-refresh\"></i></el-radio-button>\n            </el-radio-group>            \n          </el-row>\n          <el-row>\n            <el-input v-model=\"search_input\" placeholder=\"搜索\" size=\"medium\" prefix-icon=\"el-icon-search\"></el-input>\n          </el-row>\n        </el-col>\n      </el-row>\n    </el-header>\n    <el-main>\n      <el-card shadow=\"hover\" style=\"border-radius: 8px; margin: 0px 0px 0px 0px\">\n        <el-row>\n          <el-carousel height=\"150px\">\n            <el-carousel-item v-for=\"item in 4\" :key=\"item\">\n              <h3 class=\"small\">{{ item }}</h3>\n            </el-carousel-item>\n          </el-carousel>\n        </el-row>\n      </el-card>\n      <el-card shadow=\"hover\" style=\"border-radius: 8px; margin: 10px 0px 0px 0px; background:#9AC8E240;\">\n        <el-row type=\"flex\" justify=\"center\">\n          <el-col>\n            <el-button v-if=\"workmode\" type=\"primary\" icon=\"el-icon-close-notification\" circle @click=\"workmode = false\"></el-button>\n            <el-button v-else icon=\"el-icon-close-notification\" circle @click=\"workmode = true\"></el-button>\n          </el-col>\n          <el-col>\n            <el-popover\n              placement=\"top\"\n              v-model=\"screenshotPopover\">\n                <el-button size=\"mini\" type=\"text\" @click=\"visible = false\">取消</el-button>\n                <el-button type=\"primary\" size=\"mini\" @click=\"screenshot\">确定</el-button>\n              <el-button slot=\"reference\" icon=\"el-icon-full-screen\" circle></el-button>\n            </el-popover>            \n          </el-col>\n          <el-col>\n            <el-divider><i class=\"el-icon-folder-add\"></i>  存储</el-divider>\n            <el-form :inline=\"true\" :model=\"saveTabsGroupForm\" size=\"medium\" label-width=\"120px\">\n              <el-form-item label=\"标签组名\">\n                <el-input v-model=\"saveTabsGroupForm.groupName\" placeholder=\"需存储的标签组名\"></el-input>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\" @click=\"saveTabsGroup\">保存</el-button>\n              </el-form-item>\n            </el-form>\n            <el-divider><i class=\"el-icon-setting\"></i>  加载或删除</el-divider>\n            <el-form :model=\"reloadTabsGroupForm\" size=\"medium\" label-width=\"120px\">\n              <el-form-item label=\"标签组名\">\n                <el-select v-model=\"reloadTabsGroupForm.groupName\" placeholder=\"需要加载的标签组\">\n                  <el-option v-for=\"(vakue, key, index) in savedTabsGroupList\" :key=\"index\" :value=\"key\"></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\"  @click=\"reloadTabsGroup\">加载</el-button>\n                <el-button @click=\"deleteTabsGroup\">删除</el-button>\n              </el-form-item>\n            </el-form>\n            <el-button slot=\"reference\" icon=\"el-icon-copy-document\" circle></el-button>\n          </el-col>\n          <el-col>\n            <el-button icon=\"el-icon-eleme\" circle></el-button>\n          </el-col>\n          <el-col>\n            <el-button icon=\"el-icon-download\" circle @click=\"downloadBiliVideo\"></el-button>\n          </el-col>\n        </el-row>\n        <el-row type=\"flex\" justify=\"center\" style=\"margin: 10px 0px 0px 0px\">\n          <el-button icon=\"el-icon-alarm-clock\" circle></el-button>\n          <el-button icon=\"el-icon-date\" circle></el-button>\n          <el-button icon=\"el-icon-finished\" circle></el-button>\n          <el-button icon=\"el-icon-notebook-2\" circle></el-button>\n          <el-button icon=\"el-icon-s-data\" circle @click=\"reset\"></el-button>\n        </el-row>\n      </el-card>\n\n      <el-drawer\n        title=\"tabs reload\"\n        size=\"300px\"\n        :with-header=false\n        :visible.sync=\"drawer\"\n        direction=\"ttb\"\n        :destroy-on-close=true\n        @open=\"getSavedTabsGroupList\">\n        <el-divider><i class=\"el-icon-folder-add\"></i>  存储</el-divider>\n        <el-form :inline=\"true\" :model=\"saveTabsGroupForm\" size=\"medium\" label-width=\"120px\">\n          <el-form-item label=\"标签组名\">\n            <el-input v-model=\"saveTabsGroupForm.groupName\" placeholder=\"需存储的标签组名\"></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"saveTabsGroup\">保存</el-button>\n          </el-form-item>\n        </el-form>\n        <el-divider><i class=\"el-icon-setting\"></i>  加载或删除</el-divider>\n        <el-form :model=\"reloadTabsGroupForm\" size=\"medium\" label-width=\"120px\">\n          <el-form-item label=\"标签组名\">\n            <el-select v-model=\"reloadTabsGroupForm.groupName\" placeholder=\"需要加载的标签组\">\n              <el-option v-for=\"(vakue, key, index) in savedTabsGroupList\" :key=\"index\" :value=\"key\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\"  @click=\"reloadTabsGroup\">加载</el-button>\n            <el-button @click=\"deleteTabsGroup\">删除</el-button>\n          </el-form-item>\n        </el-form>\n      </el-drawer>\n\n    </el-main>\n  </el-container>\n</template>\n\n<script>\nimport axios from 'axios'\n  export default {\n    name: 'app',\n    data() {\n      return {\n        isGif: false,\n        workmode: false,\n        search_mode: '历史记录',\n        screenshotPopover: false,\n        pngurl: 'assets/start.png',\n        gifurl: 'assets/start.gif',\n        search_input: '',\n        savedTabsGroupList: {},\n        saveTabsGroupForm: {groupName: ''},\n        reloadTabsGroupForm: {groupName: ''},\n        drawer: false,\n        testurl: \"https://cn-hbwh-fx-bcache-07.bilivideo.com/upgcxcode/93/46/496394693/496394693-1-208.mp4?e=ig8euxZM2rNcNbRH7bdVhwdlhWejhwdVhoNvNC8BqJIzNbfq9rVEuxTEnE8L5F6VnEsSTx0vkX8fqJeYTj_lta53NCM=&uipk=5&nbs=1&deadline=1649952886&gen=playurlv2&os=bcache&oi=1939639253&trid=00008d13e1dbb5004d588c99cb996dd2372bT&platform=html5&upsig=76a789f9b03595e4f7b55d17e28063d1&uparams=e,uipk,nbs,deadline,gen,os,oi,trid,platform&cdnid=3877&mid=23178869&bvc=vod&nettype=0&bw=196134&orderid=0,1&logo=80000000\",\n      };\n    },\n    methods: {\n      screenshot () {\n        chrome.tabs.captureVisibleTab(null, {format: \"png\", quality: 100}, (img_url) => {\n          chrome.downloads.download({url: img_url, saveAs: true}, (res) => {console.log(res)});\n        });\n      },\n      getTabs () {\n        chrome.tabs.query({}, (tabs) => {\n          var urls = tabs.map((tab) => {return tab.url});\n          chrome.storage.local.set({\"test\":urls});\n        });\n      },\n      getSavedTabsGroupList () {\n        chrome.storage.local.get(\"savedTabsGroupList\", (entry) => {\n          this.savedTabsGroupList = (typeof(entry.savedTabsGroupList) == 'undefined') ? {} : entry.savedTabsGroupList;\n          });\n      },\n      saveTabsGroup () {\n        chrome.tabs.query({}, (tabs) => {\n          var urls = tabs.map((tab) => {return tab.url});\n          this.savedTabsGroupList[this.saveTabsGroupForm.groupName] = urls;\n          chrome.storage.local.set({\"savedTabsGroupList\":this.savedTabsGroupList});\n        });\n      },\n      reloadTabsGroup () {\n        chrome.storage.local.get(\"savedTabsGroupList\", (entry) => {\n          entry.savedTabsGroupList[this.reloadTabsGroupForm.groupName].forEach(URL => {chrome.tabs.create({url:URL})});\n        });\n      },\n      reset () {\n        chrome.storage.local.clear(() => {console.log(\"clear\")})\n      },\n      deleteTabsGroup () {\n        console.log(this.savedTabsGroupList);\n        chrome.storage.local.get(\"savedTabsGroupList\", (entry) => {\n          this.savedTabsGroupList = (typeof(entry.savedTabsGroupList) == 'undefined') ? {} : entry.savedTabsGroupList;\n          delete entry.savedTabsGroupList[this.reloadTabsGroupForm.groupName];\n          console.log(this.savedTabsGroupList)\n          chrome.storage.local.set({\"savedTabsGroupList\":this.savedTabsGroupList});\n        });\n      },\n      testdownload () {\n        console.log(\"testdownload\");\n        console.log(this.testurl);\n        chrome.downloads.download({url: this.testurl, saveAs: true});\n      },\n      downloadBiliVideo () {\n        chrome.tabs.query({currentWindow: true, active: true}, (tabs) => {\n          var bv = tabs[0].url.match(/[\\s\\S]*(BV[a-z|A-Z|0-9]{10})[\\s\\S]*/)[1];\n          var aidModel = \"https://api.bilibili.com/x/web-interface/archive/stat?bvid=\";\n          var cidModel = \"https://api.bilibili.com/x/player/pagelist?bvid=\";\n          let requests = [];\n          let getAid = new Promise((resolve) => {\n            axios({method: \"GET\", url: aidModel + bv}).then(res => resolve(res));\n          });\n          requests.push(getAid);\n          let getCid = new Promise((resolve) => {\n            axios({method: \"GET\", url: cidModel + bv}).then(res => resolve(res));\n          });\n          requests.push(getCid);\n          Promise.all(requests).then((replist) => {\n            var aid = replist[0].data.data.aid;\n            var cid = replist[1].data.data[0].cid;\n            var req = \"https://api.bilibili.com/x/player/playurl?avid=\"+ aid +\"&cid=\"+ cid +\"&qn=1&type=&otype=json&platform=html5&high_quality=1\";\n            axios({method: \"GET\", url: req}).then((res) => {\n              var videoURL = res.data.data.durl[0].url;\n              console.log(videoURL);\n              chrome.downloads.download({url: videoURL, saveAs: true});\n            });\n          });\n        });\n      },\n    }\n  };\n</script>\n\n<style>\n.main_app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n.el-carousel__item h3 {\n  color: #475669;\n  font-size: 14px;\n  opacity: 0.75;\n  line-height: 150px;\n  margin: 0;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}